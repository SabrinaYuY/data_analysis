---
title: "Project3 Part2 Analysis"
author: "Yining Li & Sabrina Yu"
date: "8/23/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


```{r my_rf_cv}
library(palmerpenguins)
library(randomForest)
library(ggplot2)
data(penguins)
read.csv("./Data/my_penguins.csv")
source("./Code/my_rf_cv_copy.R")
# Predict `body_mass_g` using covariates `bill_length_mm`, `bill_depth_mm`, and 
# `flipper_length_mm` with `my_knn_cv` function and iterate through k 
# in c(2, 5, 10)  for 30 iterations each.
# Save the iteration results
my_penguins <- na.omit(my_penguins)
data_peng <- my_penguins[, c("bill_length_mm", "bill_depth_mm", 
                       "flipper_length_mm", "body_mass_g")]
test <- my_penguins[, c("species")]
train_err <- rep(NA, 10)
cv_err <- rep(NA, 10)

rf_2 <- replicate(30, my_rf_cv(2))
rf_5 <- replicate(30, my_rf_cv(5))
rf_10 <- replicate(30, my_rf_cv(10))
# record the store the CV estimated MSE
rf_df <- data.frame("k" = c(rep(2,30),rep(5,30), rep(10,30)),
                 "cv" = c(rf_2,rf_5,rf_10))
# Plot the results as a boxplot
rf_plot <- ggplot(rf_df, aes(factor(k), cv)) +
  geom_boxplot() +
  labs(x = c("k"), y = c("MSE"))
rf_plot
# Display the statistics of the results as a table
rf_table <- data.frame("k" = c(2, 5, 10),
                       "Mean" = c(mean(rf_2),mean(rf_5),mean(rf_10)),
                       "Standard Deviation" = c(sd(rf_2),sd(rf_5),sd(rf_10)))
rf_table

ggsave('myplot.png', path = "./Output/Figures")
saveRDS(rf_table, file = './Output/Results/table.rds')
write.csv(rf_df, file = './Output/Results/simulation.csv')
```
